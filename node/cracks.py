from __future__ import absolute_import, unicode_literals
from .celery import app
import time
import random
import json


@app.task(bind=True, max_retries=3, default_retry_delay=1 * 6)
def hashcat(self, job):
    try:
        job = json.loads(job)
        job['results'] = []

        for t in job['targets']:
            job['results'].append('vul')
        if random.randint(0, 10) < 3:
            raise Exception("My Exception")
        return job
    except Exception as ex:
        raise self.retry(ex=ex, countdown=60)
