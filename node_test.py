from node.modules import Job
from node.exploits import pocsuite, msfrpc
from node.customs import exec_command
import time

j = Job()
j.target = '127.0.0.1:4434'
# msfrpc.delay(j.toJSON())
# exec_command.delay(j.toJSON())
# for i in xrange(10):
#     print i
#time.sleep(3 * 1)
j.action = 'node.exploits.pocsuite'
j.params = {"pocfile": "dlink_command_php_exec_noauth.py",
            "pocname": "dlink_command_php_exec_noauth", "mode": "verify"}
res = pocsuite.delay(j.toJSON())
# res = pocsuite.delay(j.toJSON())
print j.toJSON()
j.uuid = str(res)

j.target = 'exec'
j.action = 'node.customs.exec_command'
j.params = {'cmd': 'nmap -T4 -F 127.0.0.1'}
id = exec_command.delay(j.toJSON())
print j.toJSON()
j.uuid = str(id)
print id.get()
# j.result = res.get()
# print j.toJSON()
